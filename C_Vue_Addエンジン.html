<script name="vue">
(function()
{
	function Addエンジン()
	{
		function defval(){
			return {
        マスク:true,
        マスクサイズ:{w:150,h:100},
        画像アドレス:"a",
			};
		};

    function datainit(){
        ret = defval();

        return ret;
    };

		const quiz = {
			data(){
				return datainit();
			},
			computed:{
			},
			watch:{
        "画像アドレス":function(){
          console.log()
          this.マスク=true;
          this.マスクリサイズ( document.querySelector(".draw img") );
        }
			},
			methods:{
				問題(){
          return this.画像アドレス;
				},
        マスク切り替え(){
          this.マスク = !this.マスク;
        },
        画像読み込み完了(){
          this.マスクリサイズ( document.querySelector(".draw img:not(.noactive)") );
        },
        マスクリサイズ(画像)
        {
          let w = 画像.width;
          let h = 画像.height;
          let hi = w/h;

          this.マスクサイズ.h = h*0.25;
          this.マスクサイズ.w = this.マスクサイズ.h*hi;
        },
        async 画像保存(){
          // GASウェブアプリのURL
          const gasUrl = deployUrl;
          //console.log(gasUrl);

          /* 追加ロジックはどうやってもうまくいかない。クラウドプラットフォームをなんとかするしかないか、、 */
          if(1)
          {
            // 送信するデータ
            const data = {
              img: this.画像アドレス,
            };

            // POSTリクエストのオプション
            const options = {
              method: 'POST',
              headers: {
                "Content-Type" : "application/x-www-form-urlencoded",
              },
              body: JSON.stringify(data)
            };

            // POSTリクエストを送信
            fetch(gasUrl, options)
              .then(response => response.json())
              .then(data => console.log(data))
              .catch(error => console.error('エラー:', error));
          }
          else if(0)
          {
            const data = {};
            data.method = 'POST';
            data.headers = {
                'Accept': 'application/json',
                'Content-Type': 'application/x-www-form-urlencoded',
            }
            const params = new URLSearchParams();
            data.body = params;
            const res = await fetch(gasUrl, data).catch(e=>console.error(e));
            const json = await res.json();
            return json;
          }
        }
			}
		}
		
		return Vue.createApp( quiz ).mount( "#d_問題" );
	};

  window.Addエンジン = Addエンジン;
})();
</script>